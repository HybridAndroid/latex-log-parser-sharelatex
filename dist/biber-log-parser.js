// Generated by CoffeeScript 1.10.0
define(function() {
  var BiberLogParser, LINE_SPLITTER_REGEX;
  LINE_SPLITTER_REGEX = /^\[(\d+)].*>\s(INFO|WARN|ERROR)\s-\s(.*)$/;
  BiberLogParser = function(text, options) {
    this.text = text.replace(/(\r\n)|\r/g, '\n');
    this.options = options;
    this.lines = text.split('\n');
    return this.parse = function() {
      var result;
      result = {
        all: [],
        errors: [],
        warnings: [],
        files: [],
        typesetting: []
      };
      this.lines.forEach(function(line) {
        var fullLine, lineNumber, match, message, messageType, newEntry;
        match = line.match(LINE_SPLITTER_REGEX);
        if (match) {
          fullLine = match[0], lineNumber = match[1], messageType = match[2], message = match[3];
          newEntry = {
            file: null,
            level: messageType,
            message: message,
            line: null,
            raw: fullLine
          };
          result.all.push(newEntry);
          switch (newEntry.level) {
            case 'ERROR':
              return result.errors.push(newEntry);
            case 'WARN':
              return result.warnings.push(newEntry);
          }
        }
      });
      return result;
    };
  };
  return BiberLogParser;
});
